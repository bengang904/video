<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="shortcut icon" href="https://2024-10-24.zip/images/video.jpg">
<link rel="icon" href="https://2024-10-24.zip/images/video.jpg">
<link rel="apple-touch-icon-precomposed" href="https://2024-10-24.zip/images/video.jpg">
<meta name="msapplication-TileImage" content="https://2024-10-24.zip/images/video.jpg">
<title>Video Shorts - 视频簿</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
:root{
  --primary:#ff0000;
  --bg:#0f0f0f;
  --text:#fff;
  --muted:#aaa;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color: transparent;}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:Roboto,Arial,sans-serif;}
html, body, .shorts-container, .video-item, .info, .actions {user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-touch-callout:none;}
header{position:fixed;top:0;left:0;width:100%;background:#1a1a1a;padding:10px 14px;display:flex;justify-content:center;z-index:100;}
.search-bar{display:flex;align-items:center;gap:6px;width:90%;max-width:400px;}
.search-bar input{flex:1;padding:8px 12px;border-radius:20px;border:none;outline:none;background:#2a2a2a;color:#fff;font-size:14px;}
.search-bar button{background:#2a2a2a;border:none;border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;cursor:pointer;}
.search-bar button:hover{background:#333;}
.search-bar .material-icons{color:#fff;font-size:22px;}
.shorts-container{position:relative;width:100%;height:100vh;overflow:hidden;padding-top:60px;}
.video-item{position:relative;margin:0 auto;width:100%;max-width:450px;height:calc(100vh - 80px);background:#000;display:flex;align-items:center;justify-content:center;border-radius:12px;overflow:hidden;cursor:pointer;}
.video-item video{width:100%;height:100%;object-fit:contain;background:#000;}
.info{position:absolute;left:14px;bottom:20px;z-index:10;width:75%;}
.author{display:flex;align-items:center;gap:10px;margin-bottom:6px;}
.author img{width:40px;height:40px;border-radius:50%;}
.author-name{font-weight:500;font-size:15px;}
.title{font-size:17px;line-height:1.5;margin:6px 0;}
.tags{font-size:13px;color:var(--muted);margin-bottom:8px;}
.music-info{display:flex;align-items:center;gap:6px;font-size:13px;color:var(--muted);cursor:pointer;pointer-events:auto;}
.music-info .material-icons{font-size:18px;color:var(--muted);}
.actions{position:absolute;right:12px;bottom:100px;display:flex;flex-direction:column;align-items:center;gap:22px;z-index:10;pointer-events:auto;}
.action-btn{display:flex;flex-direction:column;align-items:center;cursor:pointer;transition:transform .2s;}
.action-btn:hover{transform:scale(1.1);}
.action-btn .material-icons{font-size:34px;color:#fff;}
.action-btn span{font-size:13px;margin-top:4px;color:var(--muted);}
.center-play{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);cursor:pointer;z-index:5;}
.center-play.visible{opacity:1;transition:opacity .25s;}
.center-play.hidden{opacity:0;transition:opacity .25s;}
.center-play .material-icons{font-size:70px;color:rgba(255,255,255,0.85);}
.progress-container{position:absolute;bottom:0;left:0;width:100%;height:5px;background:rgba(255,255,255,0.2);cursor:pointer;pointer-events:auto;}
.progress{height:100%;width:0%;background:var(--primary);}
#noResult{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.7);color:#fff;padding:10px 20px;border-radius:8px;font-size:15px;display:none;}
@media (max-width:500px){.video-item{max-width:100%;height:calc(100vh - 80px);border-radius:0;}.author img{width:32px;height:32px;}.title{font-size:15px;}}
</style>
</head>
<body>
<header>
  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="搜索视频标题...">
    <button id="searchBtn"><span class="material-icons">search</span></button>
  </div>
</header>
<div class="shorts-container" id="shortsContainer">
  <div class="video-item" id="videoItem">
    <video id="videoPlayer" playsinline webkit-playsinline preload="metadata"></video>
    <div class="info">
      <div class="author">
        <img src="https://2024-10-24.zip/images/video.jpg" alt="avatar">
        <div class="author-name" id="authorName"></div>
      </div>
      <div class="title" id="videoTitle"></div>
      <div class="tags" id="videoTags"></div>
      <div class="music-info" id="musicToggle"><span class="material-icons">music_note</span><span id="musicName"></span></div>
    </div>
    <div class="actions">
      <div class="action-btn" id="share-btn"><span class="material-icons">share</span><span>分享</span></div>
    </div>
    <div class="center-play visible" id="centerPlay">
      <span class="material-icons">play_arrow</span>
    </div>
    <div class="progress-container" id="progressContainer">
      <div class="progress" id="progress"></div>
    </div>
  </div>
</div>
<div id="noResult">没有匹配到视频</div>

<script>
let videos = []
let currentIndex = 0
const video = document.getElementById('videoPlayer')
const centerPlay = document.getElementById('centerPlay')
const progress = document.getElementById('progress')
const progressContainer = document.getElementById('progressContainer')
const authorName = document.getElementById('authorName')
const videoTitle = document.getElementById('videoTitle')
const videoTags = document.getElementById('videoTags')
const musicName = document.getElementById('musicName')
const musicToggle = document.getElementById('musicToggle')
const musicIcon = musicToggle.querySelector('span.material-icons')
const videoContainer = document.getElementById('videoItem')
const searchInput = document.getElementById('searchInput')
const searchBtn = document.getElementById('searchBtn')
const noResult = document.getElementById('noResult')

document.addEventListener('contextmenu', e => e.preventDefault())
document.addEventListener('copy', e => e.preventDefault())

fetch('videos.json').then(res=>res.json()).then(data=>{
  videos=data
  const params = new URLSearchParams(window.location.search)
  let src = params.get('src'), author = params.get('author'), title=params.get('title'), tags=params.get('tags'), music=params.get('music')

  if(!src || !author || !title || !tags || !music){
    if(videos.length>0){
      const v0=videos[0]
      src=src||v0.src
      author=author||v0.author
      title=title||v0.title
      tags=tags||v0.tags
      music=music||v0.music
      const url = new URL(window.location)
      url.searchParams.set('src', src)
      url.searchParams.set('author', author)
      url.searchParams.set('title', title)
      url.searchParams.set('tags', tags)
      url.searchParams.set('music', music)
      window.history.replaceState({},'',url)
    }
  }

  videos=[{src, author, title, tags, music}]
  loadVideo(0)
})

function loadVideo(index){
  const v = videos[index]
  video.src=v.src
  authorName.textContent=v.author
  videoTitle.textContent=v.title
  videoTags.textContent=v.tags
  musicName.textContent=v.music
  progress.style.width='0%'
  video.currentTime=0
  video.pause()
  video.muted=false
  centerPlay.classList.remove('hidden')
  centerPlay.classList.add('visible')
  noResult.style.display='none'
}

function togglePlay(){
  if(video.paused){video.play(); centerPlay.classList.add('hidden'); centerPlay.classList.remove('visible')}
  else{video.pause(); centerPlay.classList.add('visible'); centerPlay.classList.remove('hidden')}
}

videoContainer.addEventListener('click', e=>{
  if(e.target.closest('#musicToggle')||e.target.closest('#share-btn')||e.target.closest('#progressContainer')) return
  togglePlay()
})

let isDragging=false
function seekVideo(clientX){
  const rect=progressContainer.getBoundingClientRect()
  let pct=(clientX-rect.left)/rect.width
  pct=Math.max(0, Math.min(1,pct))
  progress.style.width=pct*100+'%'
  video.currentTime=pct*video.duration
}

progressContainer.addEventListener('mousedown',e=>{isDragging=true;seekVideo(e.clientX)})
window.addEventListener('mouseup',()=>{isDragging=false})
window.addEventListener('mousemove',e=>{if(isDragging) seekVideo(e.clientX)})

progressContainer.addEventListener('touchstart',e=>{isDragging=true;seekVideo(e.touches[0].clientX);e.preventDefault()},{passive:false})
progressContainer.addEventListener('touchmove',e=>{if(isDragging){seekVideo(e.touches[0].clientX);e.preventDefault()}},{passive:false})
window.addEventListener('touchend',()=>{isDragging=false})

video.addEventListener('timeupdate',()=>{if(!isDragging) progress.style.width=(video.currentTime/video.duration*100)+'%'})

musicIcon.addEventListener('click',e=>{e.stopPropagation();video.muted=!video.muted;musicIcon.textContent=video.muted?'music_off':'music_note'})

document.getElementById('share-btn').addEventListener('click',async e=>{e.stopPropagation(); const url=window.location.href; if(navigator.share) await navigator.share({title:'短视频分享',url}); else prompt('复制视频链接：',url)})

function showNoResult(){noResult.style.display='block';setTimeout(()=>{noResult.style.display='none'},2000)}

function searchVideo(){
  const keyword=searchInput.value.trim().toLowerCase()
  if(!keyword){noResult.style.display='none'; return}
  if(videos[0].title.toLowerCase().includes(keyword)) loadVideo(0)
  else showNoResult()
}

searchInput.addEventListener('keyup',e=>{if(e.key==='Enter') searchVideo()})
searchBtn.addEventListener('click',()=>searchVideo())
</script>
</body>
</html>
